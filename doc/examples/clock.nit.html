<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite">
<title>nit-source/examples/clock.nit</title>
</head>
<body bgcolor="white">
<pre><tt><i><font color="#9A1900"># This file is part of NIT ( http://www.nitlanguage.org ).</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># Licensed under the Apache License, Version 2.0 (the "License");</font></i>
<i><font color="#9A1900"># you may not use this file except in compliance with the License.</font></i>
<i><font color="#9A1900"># You may obtain a copy of the License at</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900">#     http://www.apache.org/licenses/LICENSE-2.0</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># Unless required by applicable law or agreed to in writing, software</font></i>
<i><font color="#9A1900"># distributed under the License is distributed on an "AS IS" BASIS,</font></i>
<i><font color="#9A1900"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</font></i>
<i><font color="#9A1900"># See the License for the specific language governing permissions and</font></i>
<i><font color="#9A1900"># limitations under the License.</font></i>

<i><font color="#9A1900"># This module provide a simple wall clock.</font></i>
<i><font color="#9A1900"># It is an example of getters and setters.</font></i>
<i><font color="#9A1900"># A beefed-up module is available in clock_more</font></i>
<b><font color="#0000FF">module</font></b> clock

<i><font color="#9A1900"># A simple wall clock with 60 minutes and 12 hours.</font></i>
<b><font color="#0000FF">class</font></b> <font color="#009900">Clock</font>
	<i><font color="#9A1900"># total number of minutes from 0 to 719</font></i>
	<b><font color="#0000FF">var</font></b> total_minutes<font color="#990000">:</font> <font color="#009900">Int</font>
	<i><font color="#9A1900"># Note: only the read acces is public, the write access is private.</font></i>

	<i><font color="#9A1900"># number of minutes in the current hour (from 0 to 59)</font></i>
	<b><font color="#0000FF">fun</font></b> minutes<font color="#990000">:</font> <font color="#009900">Int</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">return</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">%</font> <font color="#993399">60</font>
	
	<i><font color="#9A1900"># set the number of minutes in the current hour.</font></i>
	<i><font color="#9A1900"># if m &lt; 0 or m &gt;= 60, the hour will be changed accordinlgy</font></i>
	<b><font color="#0000FF">fun</font></b> minutes<font color="#990000">=(</font>m<font color="#990000">:</font> <font color="#009900">Int</font><font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">=</font> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>hours <font color="#990000">*</font> <font color="#993399">60</font> <font color="#990000">+</font> m

	<i><font color="#9A1900"># number of hours (from 0 to 11)</font></i>
	<b><font color="#0000FF">fun</font></b> hours<font color="#990000">:</font> <font color="#009900">Int</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">return</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">/</font> <font color="#993399">60</font>

	<i><font color="#9A1900"># set the number of hours</font></i>
	<i><font color="#9A1900"># the minutes will not be updated</font></i>
	<b><font color="#0000FF">fun</font></b> hours<font color="#990000">=(</font>h<font color="#990000">:</font> <font color="#009900">Int</font><font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">=</font> h <font color="#990000">*</font> <font color="#993399">60</font> <font color="#990000">+</font> minutes

	<i><font color="#9A1900"># the position of the hour arrow in the [0..60[ interval</font></i>
	<b><font color="#0000FF">fun</font></b> hour_pos<font color="#990000">:</font> <font color="#009900">Int</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">return</font></b> total_minutes <font color="#990000">/</font> <font color="#993399">12</font>

	<i><font color="#9A1900"># replace the arrow of hours (from 0 to 59).</font></i>
	<i><font color="#9A1900"># the hours and the minutes will be updated.</font></i>
	<b><font color="#0000FF">fun</font></b> hour_pos<font color="#990000">=(</font>h<font color="#990000">:</font> <font color="#009900">Int</font><font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">=</font> h <font color="#990000">*</font> <font color="#993399">12</font>

	<b><font color="#0000FF">redef</font></b> <b><font color="#0000FF">fun</font></b> to_s <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">return</font></b> <font color="#FF0000">"{hours}:{minutes}"</font>

	<b><font color="#0000FF">fun</font></b> reset<font color="#990000">(</font>hours<font color="#990000">,</font> minutes<font color="#990000">:</font> <font color="#009900">Int</font><font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">=</font> hours<font color="#990000">*</font><font color="#993399">60</font> <font color="#990000">+</font> minutes

	<b><font color="#0000FF">init</font></b><font color="#990000">(</font>hours<font color="#990000">,</font> minutes<font color="#990000">:</font> <font color="#009900">Int</font><font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>reset<font color="#990000">(</font>hours<font color="#990000">,</font> minutes<font color="#990000">)</font>

	<b><font color="#0000FF">redef</font></b> <b><font color="#0000FF">fun</font></b> <font color="#990000">==(</font>o<font color="#990000">)</font>
	<b><font color="#0000FF">do</font></b>
		<i><font color="#9A1900"># Note: o is a nullable Object, a type test is required</font></i>
		<i><font color="#9A1900"># Thanks to adaptive typing, there is no downcast</font></i>
		<i><font color="#9A1900"># i.e. the code is safe!</font></i>
		<b><font color="#0000FF">return</font></b> o <b><font color="#0000FF">isa</font></b> <font color="#009900">Clock</font> <b><font color="#0000FF">and</font></b> <b><font color="#0000FF">self</font></b><font color="#990000">.</font>total_minutes <font color="#990000">==</font> o<font color="#990000">.</font>total_minutes
	<b><font color="#0000FF">end</font></b>
<b><font color="#0000FF">end</font></b>

<b><font color="#0000FF">var</font></b> c <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">Clock</font><font color="#990000">(</font><font color="#993399">10</font><font color="#990000">,</font><font color="#993399">50</font><font color="#990000">)</font>
print <font color="#FF0000">"It's {c} o'clock."</font>

c<font color="#990000">.</font>minutes <font color="#990000">+=</font> <font color="#993399">22</font>
print <font color="#FF0000">"Now it's {c} o'clock."</font>

print <font color="#FF0000">"The short arrow in on the {c.hour_pos/5} and the long arrow in on the {c.minutes/5}."</font>

c<font color="#990000">.</font>hours <font color="#990000">-=</font> <font color="#993399">2</font>
print <font color="#FF0000">"Now it's {c} o'clock."</font>

<b><font color="#0000FF">var</font></b> c2 <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">Clock</font><font color="#990000">(</font><font color="#993399">9</font><font color="#990000">,</font> <font color="#993399">11</font><font color="#990000">)</font>
print <font color="#FF0000">"It's {c2} on the second clock."</font>
print <font color="#FF0000">"The two clocks are synchronized: {c == c2}."</font>
c2<font color="#990000">.</font>minutes <font color="#990000">+=</font> <font color="#993399">1</font>
print <font color="#FF0000">"It's now {c2} on the second clock."</font>
print <font color="#FF0000">"The two clocks are synchronized: {c == c2}."</font>
</tt></pre>
</body>
</html>
